<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>2048 Modern - 豪华版</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #4f46e5;
            --accent: #f59e0b;
            --bg: #f8fafc;
            --text: #1e293b;
        }

        body {
            background: linear-gradient(135deg, var(--bg) 0%, #e2e8f0 100%);
            font-family: 'Inter', system-ui;
            min-height: 100vh;
            color: var(--text);
        }

        .glass-container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .achievement-card {
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .changelog-entry {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loader {
            width: 40px;
            height: 40px;
            border: 3px solid var(--primary);
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container py-5" style="max-width: 800px;">
        
        <!-- 新增下载按钮 -->
        <section class="glass-container p-4 mb-4 text-center">
            <a href="https://raw.githubusercontent.com/Shu-Qi-Hang/2048_game/main/2048_new.cpp" 
               download="2048_new.cpp"
               class="btn btn-lg px-5 fw-bold"
               style="background: linear-gradient(135deg, var(--primary), var(--secondary); color: white">
               ⬇️ 下载游戏源码
            </a>
            <div class="mt-2 text-muted small">版本 v2.1.0 | 更新日期 2023-08-01</div>
        </section>

        <!-- 成就系统 -->
        <section class="glass-container p-4 mb-4">
            <h2 class="text-2xl font-bold mb-3 text-primary">
                🏆 成就殿堂
            </h2>
            <div class="achievement-carousel position-relative overflow-hidden" style="height: 200px">
            </div>
            <div class="d-flex justify-content-center gap-2 mt-3" id="carousel-dots"></div>
        </section>

        <!-- 版本历史 -->
        <section class="glass-container p-4">
            <h2 class="text-2xl font-bold mb-3 text-secondary">
                📜 开发历程
            </h2>
            <div class="scroll-container" style="max-height: 400px; overflow-y: auto">
                <div id="changelog"></div>
                <div class="text-center py-3" id="loading">
                    <div class="loader mx-auto"></div>
                    <div class="text-muted mt-2">正在加载更新日志...</div>
                </div>
            </div>
        </section>
    </div>

    <script>
        const achievements = [
            { id:1, title:"初出茅庐", desc:"完成第一次移动", icon:"🚀" },
            { id:2, title:"如日中升", desc:"合成数字512", icon:"☀️" },
            { id:3, title:"终极目标", desc:"合成数字2048", icon:"🎯" },
            { id:4, title:"闪电战", desc:"游戏在50回合内结束", icon:"⚡" },
            { id:5, title:"幸运星", desc:"连续生成3次数字4", icon:"🍀" },
            { id:6, title:"持久战", desc:"游戏持续300回合以上", icon:"🛡️" },
            { id:7, title:"超越极限", desc:"合成数字4096", icon:"💎" },
            { id:8, title:"改代码的狗", desc:"更改代码数据", icon:"👨💻" }
        ];

        class AchievementCarousel {
            constructor() {
                this.carousel = document.querySelector('.achievement-carousel')
                this.dotsContainer = document.querySelector('#carousel-dots')
                this.currentIndex = 0
                this.interval = 3000
                this.init()
            }

            init() {
                this.carousel.innerHTML = ''
                this.dotsContainer.innerHTML = ''

                achievements.forEach((ach, index) => {
                    const card = document.createElement('div')
                    card.className = `achievement-card position-absolute w-100 ${index === 0 ? 'active' : ''}`
                    card.style.cssText = `transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1); transform: translateX(${index === 0 ? 0 : 100}%); opacity: ${index === 0 ? 1 : 0};`
                    card.innerHTML = `
                        <div class="d-flex align-items-center" style="min-height: 120px">
                            <div class="text-3xl me-3">${ach.icon}</div>
                            <div>
                                <h3 class="h5 mb-1">${ach.title}</h3>
                                <p class="text-muted small mb-0">${ach.desc}</p>
                            </div>
                        </div>
                    `
                    this.carousel.appendChild(card)

                    const dot = document.createElement('div')
                    dot.style.cssText = `
                        width: 10px;
                        height: 10px;
                        border-radius: 50%;
                        background: ${index === 0 ? 'var(--primary)' : '#ddd'};
                        cursor: pointer;
                        transition: background 0.3s;
                    `
                    dot.addEventListener('click', () => this.goToSlide(index))
                    this.dotsContainer.appendChild(dot)
                })

                this.startAutoScroll()
                this.addEventListeners()
            }

            startAutoScroll() {
                this.intervalId = setInterval(() => this.nextSlide(), this.interval)
            }

            nextSlide() {
                const cards = document.querySelectorAll('.achievement-card')
                cards[this.currentIndex].style.transform = 'translateX(-100%)'
                cards[this.currentIndex].style.opacity = '0'
                
                this.currentIndex = (this.currentIndex + 1) % achievements.length
                
                cards[this.currentIndex].style.transform = 'translateX(0)'
                cards[this.currentIndex].style.opacity = '1'
                this.updateDots()
            }

            updateDots() {
                this.dotsContainer.childNodes.forEach((dot, index) => {
                    dot.style.background = index === this.currentIndex ? 'var(--primary)' : '#ddd'
                })
            }

            addEventListeners() {
                this.carousel.addEventListener('mouseenter', () => clearInterval(this.intervalId))
                this.carousel.addEventListener('mouseleave', () => this.startAutoScroll())
            }
        }

        async function loadChangelog() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/Shu-Qi-Hang/2048_game/main/day.txt')
                if (!response.ok) throw new Error(`HTTP错误 ${response.status}`)
                
                const text = await response.text()
                const logs = text.split('\n').filter(line => line.trim().length > 0)

                const container = document.getElementById('changelog')
                container.innerHTML = ''
                
                logs.forEach((line, index) => {
                    const [date, version, ...descParts] = line.split(/\s+/)
                    const entry = document.createElement('div')
                    entry.className = 'changelog-entry mb-3 p-3 bg-white rounded shadow-sm'
                    entry.style.animationDelay = `${index * 0.1}s`
                    entry.innerHTML = `
                        <div class="d-flex align-items-start">
                            <div class="text-muted small me-3" style="min-width: 100px">${date}</div>
                            <div class="flex-grow-1">
                                <span class="badge bg-primary">${version}</span>
                                <span class="ms-2">${descParts.join(' ')}</span>
                            </div>
                        </div>
                    `
                    container.appendChild(entry)
                })

                document.getElementById('loading').remove()
            } catch (err) {
                document.getElementById('loading').innerHTML = `
                    <div class="alert alert-danger">
                        加载失败: ${err.message}<br>
                        <small>请检查网络连接或稍后重试</small>
                    </div>
                `
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new AchievementCarousel()
            loadChangelog()
        })
    </script>
</body>
</html>
